---
author: 'xhddxiin'
title: 如何治理测试环境？
date: 2023-09-13
draft: false
description: "  "
thumbnail:
  url: /img/swimmingpool.jpg
  author: z pm
  authorURL: 
  originURL: https://unsplash.com/photos/j4_gi5yHZxU
  originName: Unsplash
---
## 测试环境为什么不稳定
1. 投入不够，不重视，对问题的响应不及时
2. 没有或者对应的流程机制不完善
3. 测试活动会产生脏数据
4. 工具配套不完善，测试环境的配置和生产没有保持同步

虽然有以上种种原因，但是就我这些年测试环境维护的经验来看，即便是把流程机制建立起来，工具配置和生产保持同步
问题的响应机制确立下来，线下环境也还是会不稳定，这很好理解，线下测试环境是相对于生产环境而言的，生产环境一般都
很稳定，因为生产环境**不会有不稳定的代码**，**也不会有频繁的变更**，相对而言测试环境不稳就是必然的，因为
1.线下环境本身就是服务于开发和测试，频繁变更代码配置，**有不稳定的代码**
2.与生产环境相对应，线下测试环境的不稳定所导致的问题和**影响小**
我们需要有一个地方来运行不稳定的代码，因为我们害怕不稳定代码上下后会导致很大的问题，所以测试环境的设计就是
为了低利害的处理不稳定的代码，而低厉害必然导致低优先级，故而测试环境不稳定是必然的
## 如何让测试环境稳定一些？
我觉得可以采取一下的措施来着手解决问题
1. 明确具体原因，当遇到除自己应用代码之外的问题而导致的失败时，不要概括的说环境原因一笔带过，需要深究一下到
   底是那里的原因，是配置问题？是数据库脏某张表脏数据？只有明确了具体原因，收集起常见的问题并分类，才能开始有
   针对性的制定解决方案
2. 问题分类拆解，在收集了一波“环境问题”之后，我们不难总结，这些问题无外乎来自三个地方\
   i.基础设施的问题 \
   ii.代码问题 \
   iii.配置问题
3. 对策，基础设施的稳定是非常关键的一环。如果基础设施不稳定，就会出现“排查疲劳”：每次遇到一些奇怪的问题（启动超时、
   调不通、等等），如果排查下来10次有9次是基础设施的问题，大家渐渐就不愿意排查了（因为不是代码的问题），一些真正
   的代码问题也会被漏过\
   i.在云服务上单独开个测试环境的租户空间，使测试环境基础设施使用和生产环境一样的标准，这个阿里，蚂蚁目前都是这么做
   的。线下环境直接放在基础设施的生产机房跑之后，基础设施团队直接按照运维其他生产机房那样去运维，中间件、数据库、缓存、
   物理机、网络、机房等所有的监控告警、巡检、发布和变更、应急、自愈能力等等都能做到位\
   ii.稳定的主干环境，主干环境的稳定重点保障两个方面，一是单应用的稳定性，而是链路的稳定性，使用持续测试平台，小时级
   跑脚本，跑用例，当发生了一问题，但是没有验证脚本发现时，酒吧这个问题的常见补充到链路验证脚本里去\
   iii.建设多套dev环境，作为开发自测和单应用提测的环境，且dev环境之间使用隔离策略